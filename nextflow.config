// Singularity containter cache. Change this as appropriate
singularity {
	cacheDir = "/scratch/project/gihcomp/MET/pipeline/singularity"
}

// Process settings. Set job scheduler if appropriate (SLURM, PBS e.g.)
// If your job scheduler has different queues/partitions for cpu and gpu, please also set them here
process {
        executor='slurm'
	clusterOptions = '--partition=general'
	//clusterOptions = '--exclude=v[1-4]'
}

// Default parameters. Commandline parameters will take priority over these
params {
        outdir = './results'
	ref_human= '/scratch/project/gihcomp/MET/pipeline/data/chm13v2.0.fa.gz'
	skip_porechop = false
	porechop_args = ""
	porechop_threads = 4
	skip_extract_adaptive = false
	minimap_threads = 12
	skip_remove_human_reads =false
}

mounts {
        outdir = "-B \"`[[ \"${params.outdir}\" =~ ^/ ]] && echo ${params.outdir} || echo ${PWD}/${params.outdir}`\""
        //datadir = "-B \"`[[ \"${params.datadir}\" =~ ^/ ]] && echo ${params.datadir} || echo ${PWD}/${params.datadir}`\""
}

singularity {
    enabled = true
    autoMounts = false
    runOptions = "-B \"$launchDir\" $mounts.outdir"
    //runOptions = "-B \"$launchDir\" $mounts.datadir $mounts.outdir"
}

// Not generally user-modifiable !!!
process {
	withName: porechop { container = 'docker://quay.io/biocontainers/porechop:0.2.4--py310h30d9df9_3' }
	withName: extract_adaptive_readID { container = 'docker://quay.io/biocontainers/seqkit:2.4.0--h9ee0642_0' }
	withName: extract_adaptive_fastq { container = 'docker://quay.io/biocontainers/seqtk:1.3--h7132678_4' }
	//withName: minimap { container = 'docker://quay.io/biocontainers/minimap2:2.26--h7132678_0 ' }
}

// Debug and report options
trace {
  enabled = true
  file = "${params.outdir}/trace.txt"
  overwrite = true
}
timeline {
  enabled = true
  file = "${params.outdir}/timeline.html"
  overwrite = true
}
report {
  enabled = true
  file = "${params.outdir}/report.html"
  overwrite = true
}
dag {
  enabled = true
  file = "${params.outdir}/flowchart_dag.svg"
  overwrite = true
}

manifest {
  name = ''
  author = 'Valentine Murigneux, Dean Basic'
  description = 'MET analysis pipeline'
  mainScript = 'main.nf'
  version = '0.1'
}

